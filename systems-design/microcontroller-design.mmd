%%{init: {
  "theme": "dark",
  "themeVariables": {
    "primaryColor": "#0d1117",
    "primaryTextColor": "#e6edf3",
    "primaryBorderColor": "#30363d",
    "lineColor": "#58a6ff",
    "secondaryColor": "#161b22",
    "actorBorder": "#58a6ff",
    "actorBkg": "#1f6feb",
    "actorTextColor": "#ffffff",
    "signalColor": "#58a6ff",
    "loopTextColor": "#e6edf3",
    "altBackground": "#161b22",
    "altTextColor": "#e6edf3",
    "sequenceNumberColor": "#7ee787"
  }
}}%%

flowchart TD

subgraph MCU["Microcontroller Architecture (C++)"]
    subgraph CoreDomains["Domain Modules"]
        LED[LED Effects Module]
        BLE[BLE Communication Module]
        CFG[Configuration Logic]
    end

    subgraph Safety["Safety & Validation Layers"]
        VALIDATE[Validation Layer]
        IMMU[Immutable Config Objects]
        SAFEWRITE[Idempotent Flash Writes]
    end

    subgraph Support["Testing & Documentation"]
        TEST[Unit + Integration Testing Suite]
        DOCS[Doxygen / hdoc Auto-Documentation]
    end

    subgraph Ext["Future Extensibility"]
        OTA[Firmware / OTA Update Hooks]
        LOG[Diagnostic Logging Layer]
    end

    BLE --> VALIDATE
    VALIDATE --> IMMU
    IMMU --> CFG
    CFG --> LED
    CFG --> SAFEWRITE
    SAFEWRITE --> OTA
    CFG --> TEST
    CFG --> DOCS
    OTA --> LOG
end